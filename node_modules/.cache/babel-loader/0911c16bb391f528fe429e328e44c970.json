{"ast":null,"code":"var _jsxFileName = \"/home/bill/Bureau/sol/Bataille-Navale/src/Components/Login.js\";\nimport React, { Component } from \"react\";\nimport Logo from \"./logo.jpg\";\nimport { withSessionContext } from \"../Utils/SessionProvider\";\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { Link, withRouter } from \"react-router-dom\";\nimport Axios from \"axios\";\n\nclass Login extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleChangeInput = event => {\n      event.preventDefault();\n      const target = event.target; //const value = target.name === 'nom' ? target.checked : target.value;\n\n      const value = target.value;\n      const name = target.name;\n      this.setState({\n        regSucc: false,\n        logoutSucc: false,\n        [name]: value\n      });\n    };\n\n    this.submitAction = async event => {\n      event.preventDefault();\n      const myHistory = this.props.history;\n      const {\n        context\n      } = this.props;\n      const validEmailRegex = // eslint-disable-next-line no-useless-escape\n      RegExp(/^(([^<>()\\[\\].,;:\\s@\"]+(\\.[^<>()\\[\\].,;:\\s@\"]+)*)|(\".+\"))@(([^<>()[\\].,;:\\s@\"]+\\.)+[^<>()[\\].,;:\\s@\"]{2,})$/i);\n      const {\n        email,\n        password\n      } = this.state;\n      let isError = false;\n      await this.setState(prevState => {\n        return {\n          errors: prevState.errors.map(item => {\n            item.email[0].isActive = email.trim() === \"\";\n            item.email[1].isActive = !validEmailRegex.test(email);\n            item.email.forEach(value => {\n              if (value.isActive) isError = true;\n            });\n            item.badCredential[0].isActive = false;\n            item.internalError[0].isActive = false;\n            item.password[0].isActive = password.trim() === \"\";\n            item.password[1].isActive = password.length < 8;\n            item.password.forEach(value => {\n              if (value.isActive) isError = true;\n            });\n            return item;\n          })\n        };\n      });\n\n      if (!isError) {\n        await Axios.get('http://localhost:8000/api/login?email=' + email + '&password=' + password, {\n          headers: {\n            'Access-Control-Allow-Origin': '*'\n          }\n        }).then(res => {\n          if (res.status === 200) {\n            const data = res.data;\n            context.updateSession({\n              nom: data.nom,\n              prenom: data.prenom,\n              email: data.email\n            });\n            return myHistory.push(\"/\");\n          }\n        }).catch(res => {\n          /*\n          * Erreur La réquête est passée mais l'email et le mp ne concorde pas\n          *  Status = 409\n          */\n          if (res.response && res.response.status === 409) return this.setState(async prevState => {\n            return {\n              errors: await prevState.errors.map(value => value.badCredential[0].isActive = true)\n            };\n          });\n          /*\n          * Erreur interne La réquête n'est pas passée\n          *  Status = 400 ou 304\n          */\n\n          this.setState(async prevState => {\n            return {\n              errors: await prevState.errors.map(value => value.internalError[0].isActive = true)\n            };\n          });\n        });\n      }\n    };\n\n    this.state = {\n      email: \"\",\n      password: \"\",\n      regSucc: this.props.location.state ? this.props.location.state.regSucc : false,\n      logoutSucc: this.props.location.state ? this.props.location.state.logoutSucc : false,\n      errors: [{\n        'email': [{\n          isActive: false,\n          type: 'emailNotBlank',\n          message: 'L\\'email ne doit pas être vide.'\n        }, {\n          isActive: false,\n          type: 'emailValid',\n          message: 'L\\'email n\\'est pas valide.'\n        }],\n        'password': [{\n          isActive: false,\n          type: 'passNotBlank',\n          message: 'Le mot de passe ne doit pas être vide.'\n        }, {\n          isActive: false,\n          type: 'passMin',\n          message: 'Le champ mot de passe ne peut être inférieur à 8.'\n        }],\n        'badCredential': [{\n          isActive: false,\n          type: 'badcredential',\n          message: 'Email ou mot de passe invalide.'\n        }],\n        internalError: [{\n          isActive: false,\n          type: 'internError',\n          message: 'Erreur interne du serveur. Contactez l\\'administrateur. '\n        }]\n      }]\n    };\n  }\n\n  componentDidMount() {\n    if (this.props.context.isLogged) return this.props.history.push('/');\n  }\n\n  render() {\n    const {\n      errors,\n      email,\n      password,\n      regSucc,\n      logoutSucc\n    } = this.state;\n    return React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 41\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 42\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-md-4 mx-auto card\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 43\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"card-header text-center bg-transparent\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 44\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: Logo,\n      className: \"img\",\n      alt: \"logo\",\n      width: \"256\",\n      height: \"128\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 45\n      },\n      __self: this\n    })), errors[0].badCredential[0].isActive && React.createElement(\"div\", {\n      className: \"alert alert-danger\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 47\n      },\n      __self: this\n    }, errors[0].badCredential[0].message), errors[0].internalError[0].isActive && React.createElement(\"div\", {\n      className: \"alert alert-danger\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 50\n      },\n      __self: this\n    }, errors[0].internalError[0].message), errors[0].email.map((item, index) => {\n      if (item.isActive) return React.createElement(\"div\", {\n        key: index,\n        className: \"alert alert-danger\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 55\n        },\n        __self: this\n      }, item.message);\n      return '';\n    }), errors[0].password.map((item, index) => {\n      if (item.isActive) return React.createElement(\"div\", {\n        key: index,\n        className: \"alert alert-danger\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 60\n        },\n        __self: this\n      }, item.message);\n      return '';\n    }), regSucc && React.createElement(\"div\", {\n      className: \"alert alert-success\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63\n      },\n      __self: this\n    }, \"Votre compte a bien \\xE9t\\xE9 enregister.\"), logoutSucc && React.createElement(\"div\", {\n      className: \"alert alert-info\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66\n      },\n      __self: this\n    }, \"Vous avez bien \\xE9t\\xE9 d\\xE9connecter.\"), React.createElement(\"div\", {\n      className: \"card-body\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69\n      },\n      __self: this\n    }, React.createElement(\"form\", {\n      className: \"form-group\",\n      onSubmit: this.submitAction,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      className: \"sr-only\",\n      htmlFor: \"email\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72\n      },\n      __self: this\n    }, \"Username\\\\Email\"), React.createElement(FontAwesomeIcon, {\n      icon: ['fas', 'user-alt'],\n      className: \"input-icon\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      required: true,\n      autoFocus: true,\n      name: \"email\",\n      type: \"text\",\n      value: email,\n      onChange: this.handleChangeInput,\n      className: \"padded-form-input form-control\",\n      id: \"email\",\n      \"aria-describedby\": \"emailHelp\",\n      placeholder: \"Votre email\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      className: \"sr-only\",\n      htmlFor: \"password\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78\n      },\n      __self: this\n    }, \"Password\"), React.createElement(FontAwesomeIcon, {\n      icon: ['fas', 'lock'],\n      className: \"input-icon\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      required: true,\n      name: \"password\",\n      type: \"password\",\n      value: password,\n      onChange: this.handleChangeInput,\n      className: \"padded-form-input form-control\",\n      id: \"password\",\n      placeholder: \"mot de passe\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"d-flex justify-content-around\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"form-check\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"checkbox\",\n      className: \"form-check-input\",\n      id: \"Check1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      className: \"form-check-label\",\n      htmlFor: \"Check1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    }, \"Se souvenir de moi\")))), React.createElement(\"input\", {\n      type: \"submit\",\n      className: \"btn btn-outline-primary btn-rounded btn-block my-2\",\n      value: \"Connexion\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, \"Not a member?\", React.createElement(Link, {\n      className: \"btn btn-outline-success btn-rounded btn-block\",\n      to: '/register',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, \"Cr\\xE9er un compte\")))))));\n  }\n\n}\n\nexport default withRouter(withSessionContext(Login));","map":{"version":3,"sources":["/home/bill/Bureau/sol/Bataille-Navale/src/Components/Login.js"],"names":["React","Component","Logo","withSessionContext","FontAwesomeIcon","Link","withRouter","Axios","Login","constructor","props","handleChangeInput","event","preventDefault","target","value","name","setState","regSucc","logoutSucc","submitAction","myHistory","history","context","validEmailRegex","RegExp","email","password","state","isError","prevState","errors","map","item","isActive","trim","test","forEach","badCredential","internalError","length","get","headers","then","res","status","data","updateSession","nom","prenom","push","catch","response","location","type","message","componentDidMount","isLogged","render","index"],"mappings":"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","sourcesContent":["import React,{Component} from \"react\";\nimport Logo from \"./logo.jpg\";\nimport {withSessionContext} from \"../Utils/SessionProvider\";\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {Link,withRouter} from \"react-router-dom\";\nimport Axios from \"axios\";\nclass  Login extends Component{\n    constructor(props) {\n        super(props);\n        this.state = {\n            email: \"\",\n            password: \"\",\n            regSucc:this.props.location.state ? this.props.location.state.regSucc:false,\n            logoutSucc:this.props.location.state? this.props.location.state.logoutSucc:false,\n            errors: [{\n                'email': [\n                    {isActive: false, type: 'emailNotBlank', message: 'L\\'email ne doit pas être vide.'},\n                    {isActive: false, type: 'emailValid', message: 'L\\'email n\\'est pas valide.'}\n                ],\n                'password': [\n                    {isActive: false, type: 'passNotBlank', message: 'Le mot de passe ne doit pas être vide.'},\n                    {isActive: false, type: 'passMin', message: 'Le champ mot de passe ne peut être inférieur à 8.'}\n                ],\n                'badCredential': [\n                    {isActive: false, type: 'badcredential', message: 'Email ou mot de passe invalide.'}\n                ],\n                internalError: [\n                    {isActive: false, type: 'internError', message: 'Erreur interne du serveur. Contactez l\\'administrateur. '},\n                ]\n            }]\n        };\n    }\n    componentDidMount() {\n        if (this.props.context.isLogged)\n            return this.props.history.push('/')\n    }\n\n    render() {\n         const {errors,email,password,regSucc,logoutSucc} = this.state;\n        return(\n            <div className=\"container\">\n                <div className=\"row\">\n                    <div className=\"col-md-4 mx-auto card\">\n                        <div className=\"card-header text-center bg-transparent\">\n                            <img src={Logo} className=\"img\" alt=\"logo\" width=\"256\" height=\"128\"/>\n                        </div>\n                        {errors[0].badCredential[0].isActive && <div className=\"alert alert-danger\">\n                            {errors[0].badCredential[0].message}\n                        </div>}\n                        {errors[0].internalError[0].isActive && <div className=\"alert alert-danger\">\n                            {errors[0].internalError[0].message}\n                        </div>}\n                        {errors[0].email.map((item,index) => {\n                            if (item.isActive)\n                                return <div key={index} className=\"alert alert-danger\">{item.message}</div>;\n                            return ''\n                        })}\n                        {errors[0].password.map((item,index) => {\n                            if (item.isActive)\n                                return <div key={index} className=\"alert alert-danger\">{item.message}</div>;\n                            return ''\n                        })}\n                        {regSucc && <div className=\"alert alert-success\">\n                           Votre compte a bien été enregister.\n                        </div>}\n                        {logoutSucc && <div className=\"alert alert-info\" >\n                            Vous avez bien été déconnecter.\n                        </div>}\n                        <div className=\"card-body\">\n                            <form className=\"form-group\" onSubmit={this.submitAction}>\n                                <div className=\"form-group\">\n                                    <label className=\"sr-only\" htmlFor=\"email\">Username\\Email</label>\n                                    <FontAwesomeIcon icon={['fas', 'user-alt']} className=\"input-icon\"/>\n                                    <input required autoFocus name=\"email\" type=\"text\"\n                                           value={email} onChange={this.handleChangeInput}\n                                           className=\"padded-form-input form-control\" id=\"email\"\n                                           aria-describedby=\"emailHelp\"  placeholder={\"Votre email\"}/>\n                                        <label className=\"sr-only\" htmlFor=\"password\" >Password</label>\n                                    <FontAwesomeIcon icon={['fas', 'lock']} className=\"input-icon\"/>\n                                        <input required name=\"password\" type=\"password\"\n                                               value={password} onChange={this.handleChangeInput}\n                                               className=\"padded-form-input form-control\" id=\"password\"\n                                               placeholder={\"mot de passe\"}/>\n                                        </div>\n\n                                <div className=\"d-flex justify-content-around\">\n                                    <div>\n                                        <div className=\"form-check\">\n                                            <input type=\"checkbox\" className=\"form-check-input\" id=\"Check1\"/>\n                                                <label className=\"form-check-label\" htmlFor=\"Check1\">Se souvenir de moi</label>\n                                        </div>\n                                    </div>\n\n                                </div>\n                                <input type=\"submit\" className=\"btn btn-outline-primary btn-rounded btn-block my-2\" value=\"Connexion\"/>\n                                <p>Not a member?\n                                    <Link className=\"btn btn-outline-success btn-rounded btn-block\"\n                                       to={'/register'}>Créer un compte</Link>\n                                </p>\n                            </form>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        )\n    }\n    handleChangeInput = (event) =>{\n        event.preventDefault();\n        const target = event.target;\n        //const value = target.name === 'nom' ? target.checked : target.value;\n        const value = target.value;\n        const name = target.name;\n        this.setState({\n            regSucc:false,\n            logoutSucc:false,\n            [name]: value\n\n        });\n    };\n\n    submitAction = async (event)=> {\n        event.preventDefault();\n        const myHistory = this.props.history;\n        const {context} = this.props;\n        const validEmailRegex =\n            // eslint-disable-next-line no-useless-escape\n            RegExp(/^(([^<>()\\[\\].,;:\\s@\"]+(\\.[^<>()\\[\\].,;:\\s@\"]+)*)|(\".+\"))@(([^<>()[\\].,;:\\s@\"]+\\.)+[^<>()[\\].,;:\\s@\"]{2,})$/i);\n\n        const {email, password} = this.state;\n        let isError = false;\n        await this.setState(prevState => {\n            return ({\n                errors: prevState.errors.map(\n                    item => {\n                        item.email[0].isActive = email.trim()===\"\";\n                        item.email[1].isActive =!validEmailRegex.test(email);\n                        item.email.forEach(value => {\n                            if (value.isActive) isError = true\n                        });\n                        item.badCredential[0].isActive=false;\n                        item.internalError[0].isActive=false;\n                        item.password[0].isActive = password.trim() === \"\";\n                        item.password[1].isActive = password.length < 8;\n                        item.password.forEach(value => {\n                            if (value.isActive) isError = true\n                        });\n                        return item;\n                    }\n                ) });\n\n        });\n        if (!isError){\n            await Axios.get('http://localhost:8000/api/login?email='+email+'&password='+password,\n                {headers: {'Access-Control-Allow-Origin': '*'}}\n                )\n                .then(res=>{\n                    if (res.status === 200)\n                    {\n                        const data = res.data;\n                        context.updateSession({ nom:data.nom,prenom:data.prenom,email:data.email });\n                        return myHistory.push(\"/\");\n                    }\n                })\n                .catch(res=>{\n                    /*\n                    * Erreur La réquête est passée mais l'email et le mp ne concorde pas\n                    *  Status = 409\n                    */\n                    if (res.response && res.response.status === 409)\n                        return this.setState(async (prevState) => {\n                            return (\n                                {\n                                    errors: await prevState.errors.map(value => value.badCredential[0].isActive = true)\n                                }\n                            );\n                        });\n                    /*\n                    * Erreur interne La réquête n'est pas passée\n                    *  Status = 400 ou 304\n                    */\n                    this.setState(async (prevState) => {\n                        return (\n                            {\n                                errors: await prevState.errors.map(value => value.internalError[0].isActive = true)\n                            }\n                        );\n                    });\n                })\n        }\n    };\n}\nexport default withRouter(withSessionContext(Login));"]},"metadata":{},"sourceType":"module"}